<app-header></app-header>

<div class="bg">
  <div class="cart-container">
    <h1>ตะกร้าของฉัน</h1>

    <!-- เช็คว่าตะกร้าว่างหรือไม่ -->
    <div *ngIf="cart.length === 0">
      <p>ตะกร้าของคุณยังว่างอยู่</p>
    </div>

    <!-- แสดงรายการเกมในตะกร้า -->
    <div *ngFor="let game of cart" class="cart-item-wrapper">
      <a [routerLink]="['/sellpage', game.id]" class="cart-item-link">
        <div class="cart-item">
          <img [src]="getImage(game.Gimage)" [alt]="game.Gname" />
          <div>
            <div class="text1">{{ game.Gname }}</div>
            <div class="price">ราคา: {{ game.Gprice }} บาท</div>
            <div class="text">ประเภท: {{ game.category }}</div>
          </div>
        </div>
      </a>
      <!-- ปุ่มลบยังแยกออกมา -->
      <button (click)="removeFromCart(game.id)" class="remove-btn">
        ลบออกจากตะกร้า
      </button>
    </div>

    <!-- ช่องใส่รหัสส่วนลด -->
    <div class="discount-section">
      <label for="discountCode">รหัสส่วนลด</label>
      <input
        type="text"
        id="discountCode"
        [(ngModel)]="discountCode"
        placeholder="กรอกรหัสส่วนลด"
      />
      <button (click)="applyDiscount()">ใช้รหัสส่วนลด</button>
      <p *ngIf="discountApplied">ส่วนลด: {{ discountAmount }} บาท</p>
      <p *ngIf="discountApplied">
        ราคาหลังหักส่วนลด: {{ finalPrice | number }} บาท
      </p>
    </div>

    <!-- แสดงผลรวมของราคาเกม -->
    <div class="total-price">
      <h3>รวมทั้งหมด: {{ totalPrice | number }} บาท</h3>
    </div>

    <!-- ปุ่มซื้อเกม -->
    <button (click)="buyGames()" class="but">ซื้อเกม</button>
  </div>
</div>
